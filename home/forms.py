from django import forms
from django.db.models import fields
from django.forms import widgets
from .models import MalwareFile

class FileFieldForm(forms.Form):
    file_field = forms.FileField()

    def clean_file_field(self):
        file_field = self.cleaned_data['file_field']
        file_name = file_field._name
        if file_name.endswith('.exe'):
            return self.cleaned_data['file_field']
        else:
            raise forms.ValidationError("Please upload an executed file ! (.exe)")

    def get_file_name(self):
        file_field = self.cleaned_data['file_field']
        file_name = file_field._name
        return file_name
